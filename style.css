/* style.css - Full Version v14.1 (Fixes & Mobile Chart) */

/* ============================================= */
/* === 1. ZMIENNE GLOBALNE I RESET === */
/* ============================================= */
:root {
    /* Kolory główne */
    --primary-color: #005f73;
    --secondary-color: #0a9396;
    --accent-color: #94d2bd;
    --background-color: #f4f4f9;
    --card-background: #ffffff;

    /* Kolory tekstów */
    --text-color: #333;
    --light-text-color: #ffffff;
    --muted-text-color: #666;

    /* Kolory stanów */
    --success-color: #2a9d8f;
    --inprogress-color: #e9c46a;
    --danger-color: #e76f51;
    --border-color: #e0e0e0;

    /* Gamifikacja */
    --gold-color: #e9c46a;

    /* Protocol Hub Colors (Bio-Protocols) */
    --proto-sos-bg: linear-gradient(135deg, #4c1d95 0%, #8b5cf6 100%);
    --proto-booster-bg: linear-gradient(135deg, #9f1239 0%, #fb7185 100%);
    --proto-reset-bg: linear-gradient(135deg, #047857 0%, #34d399 100%);

    /* NOWE TRYBY */
    --proto-calm-bg: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); /* Deep Blue */
    --proto-flow-bg: linear-gradient(135deg, #0e7490 0%, #22d3ee 100%); /* Cyan */
    --proto-neuro-bg: linear-gradient(135deg, #b45309 0%, #f59e0b 100%); /* Amber/Gold */
    --proto-ladder-bg: linear-gradient(135deg, #c2410c 0%, #fb923c 100%); /* Orange */

    /* Efekty */
    --shadow-card: 0 2px 8px rgba(0, 0, 0, 0.08);
    --shadow-hover: 0 4px 12px rgba(0, 0, 0, 0.15);
    --shadow-float: 0 10px 30px rgba(0, 95, 115, 0.15);
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-xl: 20px;
}

*,
*::before,
*::after {
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    margin: 0;
    background-color: var(--background-color);
    color: var(--text-color);
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

/* ============================================= */
/* === 2. NAGŁÓWEK (HEADER) === */
/* ============================================= */
header {
    background-color: var(--primary-color);
    color: var(--light-text-color);
    padding: 0.8rem 2rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    position: sticky;
    top: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 2rem;
}

.brand-container {
    display: flex;
    align-items: center;
    gap: 12px;
    text-decoration: none;
    cursor: pointer;
    transition: opacity 0.2s;
}

.brand-container:hover {
    opacity: 0.9;
}

.app-logo-small {
    height: 36px;
    width: 36px;
    border-radius: 10px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.1);
}

header h1 {
    margin: 0;
    font-size: 1.3rem;
    font-weight: 700;
    letter-spacing: -0.5px;
    white-space: nowrap;
}

header nav#main-nav {
    display: flex;
    gap: 0.5rem;
    margin: 0;
    flex-grow: 1;
    justify-content: center;
}

header nav button {
    background: transparent;
    color: rgba(255, 255, 255, 0.85);
    border: none;
    padding: 0.6rem 1.2rem;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 0.95rem;
    font-weight: 500;
}

header nav button:hover {
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
    transform: translateY(-1px);
}

#user-info-container {
    position: static;
    transform: none;
    display: flex;
    align-items: center;
    gap: 1.5rem;
    padding-left: 1rem;
    border-left: 1px solid rgba(255, 255, 255, 0.1);
}

#user-display-name {
    font-weight: 600;
    font-size: 0.9rem;
    color: #fff;
    white-space: nowrap;
}

#logout-btn {
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: #fff;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 0.85rem;
    transition: all 0.2s;
    white-space: nowrap;
    min-width: max-content;
}

#logout-btn:hover {
    background: var(--danger-color);
    border-color: var(--danger-color);
}

#logout-btn svg {
    width: 20px;
    height: 20px;
}

google-cast-launcher {
    width: 24px;
    height: 24px;
    cursor: pointer;
    opacity: 0.9;
    --connected-color: var(--gold-color);
}

/* ============================================= */
/* === 3. STRUKTURA I EKRANY === */
/* ============================================= */
main {
    padding: 1rem;
    padding-bottom: 130px !important;
    max-width: 800px;
    margin: 0 auto;
    width: 100%;
    flex: 1;
}

.screen { display: none; animation: fadeIn 0.3s ease; }
.screen.active { display: block; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

/* ============================================= */
/* === 4. EKRAN POWITALNY === */
/* ============================================= */
#welcome-screen { min-height: calc(100vh - 140px); padding: 1rem; }
#welcome-screen.active { display: flex; flex-direction: column; justify-content: center; align-items: center; }

.welcome-content {
    text-align: center; width: 100%; max-width: 600px;
    padding: 3rem 2.5rem; background-color: var(--card-background);
    border-radius: var(--radius-lg); box-shadow: 0 15px 35px rgba(0, 95, 115, 0.15);
    border: 1px solid rgba(0, 0, 0, 0.05); margin-bottom: 2rem;
}
.welcome-logo {
    width: 80px; height: 80px; border-radius: 18px; margin-bottom: 1.5rem;
    box-shadow: 0 8px 20px rgba(10, 147, 150, 0.3);
}
.welcome-content h2 { color: var(--primary-color); margin-top: 0; margin-bottom: 1.5rem; font-size: 1.8rem; font-weight: 800; }
.welcome-content p { color: var(--text-color); opacity: 0.8; font-size: 1.1rem; line-height: 1.7; margin-bottom: 2.5rem; }

/* ============================================= */
/* === 5. HERO DASHBOARD (GAMIFIKACJA) === */
/* ============================================= */
#hero-dashboard {
    background: linear-gradient(160deg, #0f1c2e 0%, var(--primary-color) 100%);
    color: var(--light-text-color);
    border-radius: var(--radius-lg);
    padding: 1rem 1.2rem; /* Reduced padding */
    margin-bottom: 1rem;
    box-shadow: 0 10px 30px rgba(0, 95, 115, 0.3);
    position: relative;
    overflow: hidden;
    display: grid;
    /* Domyślny layout (Desktop) */
    grid-template-columns: auto 1fr auto;
    gap: 1.5rem;
    align-items: center;
    min-height: 100px;
}

#hero-dashboard::before {
    content: '';
    position: absolute;
    top: -50%; left: -10%;
    width: 150%; height: 200%;
    background: radial-gradient(circle, rgba(255, 255, 255, 0.05) 0%, transparent 60%);
    pointer-events: none;
}

.hero-avatar-wrapper {
    position: relative; width: 60px; height: 60px;
    display: flex; justify-content: center; align-items: center; flex-shrink: 0;
}
.progress-ring {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 50%;
    background: conic-gradient(var(--gold-color) var(--progress-deg, 0deg), rgba(255, 255, 255, 0.1) 0deg);
    -webkit-mask: radial-gradient(transparent 55%, black 56%);
    mask: radial-gradient(transparent 55%, black 56%);
    box-shadow: 0 0 15px rgba(233, 196, 106, 0.3);
}
.hero-avatar { width: 84%; height: 84%; border-radius: 50%; z-index: 1; border: 2px solid var(--primary-color); object-fit: cover; }
.level-badge {
    position: absolute; bottom: -5px; background: var(--gold-color); color: #000;
    font-size: 0.7rem; font-weight: 800; padding: 2px 6px; border-radius: 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.3); z-index: 2; white-space: nowrap;
}

.hero-content { display: flex; flex-direction: column; justify-content: center; overflow: hidden; min-width: 0; }
.hero-rank-title {
    font-size: 1rem; font-weight: 800; margin: 0 0 0.4rem 0;
    text-transform: uppercase; letter-spacing: 1px; line-height: 1;
    background: linear-gradient(90deg, #fff, #ccc);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent; white-space: nowrap;
}

.hero-metrics-grid { display: flex; gap: 8px; flex-wrap: wrap; }
.metric-item {
    background: rgba(0, 0, 0, 0.25); padding: 4px 8px; border-radius: 8px;
    display: flex; align-items: center; gap: 8px; border: 1px solid rgba(255, 255, 255, 0.1);
    flex-grow: 0; min-width: max-content;
}
.metric-icon { width: 20px !important; height: 20px !important; display: block; flex-shrink: 0; }
.metric-text { display: flex; flex-direction: column; line-height: 1.1; }
.metric-label { font-size: 0.6rem; text-transform: uppercase; opacity: 0.7; letter-spacing: 0.5px; }
.metric-value { font-size: 0.8rem; font-weight: 700; color: #fff; white-space: nowrap; line-height: 1.2; }

/* Statusy Tarczy */
.shield-score.strong { color: var(--success-color); }
.shield-score.stable { color: var(--gold-color); }
.shield-score.vulnerable { color: var(--danger-color); }
.shield-score.critical { color: #ff4444; animation: pulse-text 2s infinite; }

/* Wykres Tygodniowy */
.hero-weekly-rhythm {
    display: flex; flex-direction: column; align-items: flex-end;
    border-left: 1px solid rgba(255,255,255,0.15); padding-left: 1.5rem; min-width: 140px; flex-shrink: 0;
}
.weekly-chart-label { font-size: 0.6rem; text-transform: uppercase; opacity: 0.6; letter-spacing: 1px; margin-bottom: 6px; font-weight: 700; }
.weekly-chart-grid { display: flex; gap: 5px; }
.week-day-col { display: flex; flex-direction: column; align-items: center; gap: 3px; }
.day-bar { width: 6px; height: 24px; border-radius: 4px; background: rgba(255,255,255,0.1); transition: all 0.3s; }
.day-label { font-size: 0.55rem; opacity: 0.5; font-weight: 600; }
.day-bar.filled { background: var(--gold-color); box-shadow: 0 0 8px rgba(233, 196, 106, 0.5); height: 24px; }
.day-bar.current { background: rgba(255,255,255,0.3); border: 1px solid rgba(255,255,255,0.5); animation: pulse-bar 2s infinite; }
.day-bar.empty { height: 12px; margin-top: auto; }

@keyframes pulse-text { 0% { opacity: 1; } 50% { opacity: 0.6; } 100% { opacity: 1; } }
@keyframes pulse-bar { 0% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4); } 70% { box-shadow: 0 0 0 4px rgba(255, 255, 255, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); } }

/* ============================================= */
/* === 6. CALENDAR SHEET (DASHBOARD) === */
/* ============================================= */

/* Nagłówek sekcji "TWOJA MISJA" */
.daily-mission-header {
    display: flex; justify-content: space-between; align-items: flex-end;
    margin: 1.5rem 0 1rem 0; padding: 0 4px;
}
.dm-text { display: flex; flex-direction: column; }
.dm-subtitle { font-size: 0.75rem; font-weight: 600; color: var(--muted-text-color); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 2px; }
.dm-title {
    font-size: 2rem; font-weight: 900; margin: 0; line-height: 0.9; text-transform: uppercase; letter-spacing: -1px;
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
}
.dm-icon-wrapper { position: relative; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; }
.dm-icon { font-size: 2rem; animation: slow-pulse 3s infinite ease-in-out; filter: drop-shadow(0 0 10px rgba(10, 147, 150, 0.4)); }
@keyframes slow-pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

/* Główny kontener "Kartki z kalendarza" */
.calendar-sheet {
    background: #fff;
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-float);
    overflow: hidden;
    position: relative;
    margin-bottom: 2rem;
    transition: transform 0.2s;
    background-image: linear-gradient(to bottom, #ffffff, #fafafa);
    border: 1px solid rgba(0,0,0,0.03);
}

/* Czerwony pasek górny (jak w kalendarzach zdzierakach) */
.calendar-top-binding {
    background: linear-gradient(135deg, #e11d48 0%, #be123c 100%);
    height: 12px;
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 2;
}

/* Nagłówek daty - duży i wyraźny */
.calendar-date-header {
    padding: 2rem 1.5rem 0.5rem 1.5rem;
    text-align: center;
    position: relative;
    border-bottom: 1px dashed var(--border-color);
}

.calendar-day-name {
    display: block;
    font-size: 1rem;
    font-weight: 700;
    text-transform: uppercase;
    color: var(--danger-color);
    letter-spacing: 2px;
    margin-bottom: 0px;
}

.calendar-day-number {
    display: block;
    font-size: 5.5rem;
    font-weight: 800;
    line-height: 1;
    color: var(--text-color);
    letter-spacing: -2px;
}

.calendar-month-year {
    display: block;
    font-size: 1.1rem;
    color: var(--muted-text-color);
    font-weight: 500;
    margin-top: -5px;
}

/* Kontekst treningowy wewnątrz kartki */
.calendar-body {
    padding: 1.5rem;
    position: relative;
}

.workout-context-card {
    background: var(--background-color);
    border-radius: var(--radius-lg);
    padding: 1rem;
    border: 1px solid rgba(0,0,0,0.05);
}

.wc-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.wc-title {
    font-size: 1.2rem;
    font-weight: 800;
    color: var(--primary-color);
    margin: 0;
    line-height: 1.2;
}

.wc-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 1rem;
}

.wc-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.85rem;
    color: var(--muted-text-color);
    margin-bottom: 1rem;
}

/* Przycisk Start na kartce */
.calendar-action-btn {
    width: 100%;
    padding: 1rem;
    border-radius: 12px;
    font-size: 1.1rem;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 1px;
    background: var(--primary-color);
    color: #fff;
    border: none;
    box-shadow: 0 4px 15px rgba(0, 95, 115, 0.3);
    cursor: pointer;
    transition: transform 0.1s, box-shadow 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.calendar-action-btn svg {
    flex-shrink: 0;
}

.calendar-action-btn:active {
    transform: scale(0.98);
}

/* Wersja REST dla kalendarza */
.calendar-sheet.rest-mode .calendar-day-name { color: #64748b; }
.calendar-sheet.rest-mode .calendar-top-binding { background: linear-gradient(135deg, #64748b 0%, #475569 100%); }
.calendar-sheet.rest-mode .calendar-action-btn { background: transparent; border: 2px solid var(--border-color); color: var(--text-color); box-shadow: none; }

/* Oś czasu nadchodzących dni */
.timeline-section-title {
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    color: var(--muted-text-color);
    margin: 0 0 1rem 4px;
    font-weight: 700;
}

.upcoming-timeline {
    display: flex;
    gap: 12px;
    overflow-x: auto;
    padding-bottom: 15px;
    padding-left: 4px;
    padding-right: 4px;
    scrollbar-width: none;
    -webkit-overflow-scrolling: touch;
}

.timeline-card {
    min-width: 85px;
    background: #fff;
    border-radius: 16px;
    border: 1px solid var(--border-color);
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 12px 8px;
    text-align: center;
    position: relative;
    box-shadow: 0 2px 5px rgba(0,0,0,0.03);
    transition: transform 0.2s;
    flex-shrink: 0;
}

.timeline-card:active { transform: scale(0.95); }

.tl-day-name {
    font-size: 0.7rem;
    font-weight: 700;
    text-transform: uppercase;
    color: var(--danger-color);
    margin-bottom: 2px;
}

.tl-day-number {
    font-size: 1.4rem;
    font-weight: 800;
    color: var(--text-color);
    line-height: 1;
    margin-bottom: 6px;
}

.tl-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--border-color);
}

.timeline-card.workout .tl-dot { background: var(--primary-color); }
.timeline-card.rest .tl-dot { background: #cbd5e1; }
.timeline-card.rest .tl-day-name { color: #94a3b8; }

/* Wellness Check-in w nowym stylu */
.sheet-wellness {
    margin-bottom: 1.5rem;
}
.sheet-wellness-label {
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--muted-text-color);
    margin-bottom: 8px;
    text-align: center;
}

/* Stare klasy Mission Card dla zachowania kompatybilności z Completed State */
.mission-card {
    background: #fff; border-radius: var(--radius-lg); padding: 1rem; margin-bottom: 1rem;
    box-shadow: 0 8px 25px rgba(0, 95, 115, 0.15); border: 2px solid var(--primary-color);
    position: relative;
}
.mission-card.completed { border-color: var(--success-color); background: linear-gradient(165deg, #ffffff 60%, #f0fff4 100%); }
.completed-header { text-align: center; padding: 1rem 0; color: var(--success-color); display: flex; flex-direction: column; align-items: center; gap: 10px; }
.completed-icon { width: 48px; height: 48px; background: #dcfce7; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 0.5rem auto; }
.completed-icon img { display: block; width: 24px; height: 24px; }
.completed-title { font-size: 1.5rem; font-weight: 800; margin: 0; color: var(--text-color); }
.completed-subtitle { font-size: 0.9rem; opacity: 0.7; margin: 0; }
.completed-stats {
    display: flex; justify-content: center; gap: 1rem; margin: 1.5rem 0; padding: 1rem;
    background: rgba(255,255,255,0.6); border-radius: 12px; border: 1px solid rgba(0,0,0,0.05); align-items: stretch;
}
.c-stat { text-align: center; flex: 1; display: flex; flex-direction: column; justify-content: space-between; gap: 5px; }
.c-stat-val { font-weight: 800; font-size: 1.1rem; color: var(--primary-color); display: flex; align-items: center; justify-content: center; min-height: 2.5rem; line-height: 1.2; }
.c-stat-label { font-size: 0.7rem; text-transform: uppercase; opacity: 0.6; letter-spacing: 1px; margin-top: auto; }

/* AI Tags */
.ai-header-strip {
    background: linear-gradient(90deg, #0f2027, #203a43);
    margin: -1rem -1rem 0.8rem -1rem; padding: 0.4rem 1rem;
    display: flex; align-items: center; justify-content: space-between;
    color: #fff; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; font-weight: 700;
    border-radius: var(--radius-lg) var(--radius-lg) 0 0;
}
.ai-header-left { display: flex; align-items: center; gap: 8px; }
.ai-dna-icon { font-size: 1.1rem; animation: spin-slow 4s linear infinite; }
@keyframes spin-slow { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
.ai-mini-tags { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 0.5rem; padding-bottom: 0.5rem; border-bottom: 1px dashed var(--border-color); }
.ai-mini-tag { font-size: 0.7rem; background: rgba(10, 147, 150, 0.1); color: var(--primary-color); padding: 3px 8px; border-radius: 4px; font-weight: 600; display: flex; align-items: center; gap: 4px; }

/* Wellness Components */
.pain-selector { display: flex; justify-content: space-between; gap: 5px; margin-bottom: 1rem; }
.pain-option {
    background: var(--background-color); border: 2px solid transparent; border-radius: 8px;
    padding: 6px 4px; flex: 1; text-align: center; cursor: pointer;
    transition: all 0.2s; font-size: 1.2rem; display: flex; flex-direction: column; align-items: center; gap: 2px;
}
.pain-option span { font-size: 0.55rem; font-weight: 600; color: var(--muted-text-color); }
.pain-option:hover { transform: translateY(-3px); }
.pain-option.selected { background: #fff; border-color: var(--primary-color); box-shadow: 0 4px 12px rgba(0,0,0,0.1); transform: scale(1.05); }
.pain-option[data-level="0"].selected { border-color: var(--success-color); background: #e6fffa; }
.pain-option[data-level="3"].selected { border-color: #9acd32; background: #f0fff4; }
.pain-option[data-level="5"].selected { border-color: var(--inprogress-color); background: #fffaf0; }
.pain-option[data-level="7"].selected { border-color: #ff8c00; background: #fff5eb; }
.pain-option[data-level="9"].selected { border-color: var(--danger-color); background: #fff5f5; }

/* --- CONTEXT MENU STYLES --- */
.ctx-menu-wrapper {
    position: relative;
    width: 24px;
    height: 24px;
}

.ctx-menu-btn {
    background: transparent;
    border: none;
    font-size: 1.5rem;
    color: #666;
    cursor: pointer;
    padding: 0;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
}

.ctx-menu-btn:hover { background: rgba(0,0,0,0.05); }

.ctx-menu-dropdown {
    display: none;
    position: absolute;
    right: 0;
    top: 100%;
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    min-width: 180px;
    z-index: 10000; /* Wysoki index */
    flex-direction: column;
    padding: 6px 0;
    margin-top: 4px;
}

.ctx-menu-dropdown.active {
    display: flex;
    animation: fadeIn 0.1s ease;
}

.ctx-action {
    background: transparent;
    border: none;
    padding: 10px 16px;
    text-align: left;
    font-size: 0.9rem;
    cursor: pointer;
    width: 100%;
    color: #333;
    display: flex;
    align-items: center;
    gap: 12px;
    white-space: nowrap;
    transition: background 0.1s;
    border-bottom: 1px solid #f0f0f0;
}

/* FIX: Ensure icons in context menu are visible */
.ctx-action svg, .ctx-action img {
    opacity: 0.7;
    width: 18px;
    height: 18px;
    flex-shrink: 0;
    display: block;
}

.ctx-action:hover {
    background: #f3f4f6;
    color: var(--primary-color);
}

.ctx-action:hover svg, .ctx-action:hover img { opacity: 1; }
.ctx-action:last-child { border-bottom: none; }

/* ============================================= */
/* === 7. BIO-HUB (PROTOKOŁY) === */
/* ============================================= */
.bio-hub-container {
    margin-top: 1.5rem;
    margin-bottom: 1rem;
}

.bio-hub-scroll {
    display: flex;
    gap: 10px;
    overflow-x: auto;
    padding-bottom: 10px;
    margin: 0;
    padding-left: 2px;
    padding-right: 2px;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: thin;
    scrollbar-color: rgba(0, 95, 115, 0.3) transparent;
}

.bio-hub-scroll::-webkit-scrollbar { height: 6px; display: block; }
.bio-hub-scroll::-webkit-scrollbar-track { background: transparent; }
.bio-hub-scroll::-webkit-scrollbar-thumb { background-color: rgba(0, 95, 115, 0.2); border-radius: 10px; }
.bio-hub-scroll::-webkit-scrollbar-thumb:hover { background-color: rgba(0, 95, 115, 0.5); }

.bio-card {
    min-width: 150px;
    width: 150px;
    height: 100px;
    border-radius: 12px;
    padding: 0.8rem;
    color: white;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    position: relative;
    overflow: hidden;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    transition: transform 0.2s;
    scroll-snap-align: start;
    flex-shrink: 0;
}

.bio-card:active { transform: scale(0.96); }

/* Warianty kart */
.bio-card-sos { background: var(--proto-sos-bg); box-shadow: 0 4px 12px rgba(139, 92, 246, 0.2); }
.bio-card-booster { background: var(--proto-booster-bg); box-shadow: 0 4px 12px rgba(244, 63, 94, 0.2); }
.bio-card-reset { background: var(--proto-reset-bg); box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2); }
.bio-card-calm { background: var(--proto-calm-bg); box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2); }
.bio-card-flow { background: var(--proto-flow-bg); box-shadow: 0 4px 12px rgba(34, 211, 238, 0.2); }
.bio-card-neuro { background: var(--proto-neuro-bg); box-shadow: 0 4px 12px rgba(250, 204, 21, 0.2); color: #fff; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
.bio-card-ladder { background: var(--proto-ladder-bg); box-shadow: 0 4px 12px rgba(251, 146, 60, 0.2); }

.bio-bg-icon { position: absolute; right: -5px; bottom: -8px; font-size: 3.5rem; opacity: 0.15; pointer-events: none; line-height: 1; }
.bio-header { display: flex; justify-content: space-between; align-items: flex-start; }
.bio-tag { font-size: 0.55rem; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 800; opacity: 0.9; background: rgba(0,0,0,0.25); padding: 2px 6px; border-radius: 4px; }
.bio-duration { font-size: 0.7rem; font-weight: 700; opacity: 0.9; }
.bio-title { font-size: 0.95rem; font-weight: 800; line-height: 1.1; margin-top: 4px; max-width: 90%; text-shadow: 0 1px 2px rgba(0,0,0,0.1); }
.bio-desc { font-size: 0.65rem; opacity: 0.9; margin-top: 2px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.2; }

/* ============================================= */
/* === 8. COMMON UI ELEMENTS === */
/* ============================================= */
.action-btn {
    display: block; width: 100%; padding: 0.8rem; font-size: 1rem; font-weight: 700;
    text-align: center; background-color: var(--secondary-color); color: var(--light-text-color);
    border: none; border-radius: var(--radius-md); cursor: pointer; transition: background-color 0.2s, transform 0.1s;
    margin-top: 0.8rem;
}
.action-btn:hover { background-color: #087f81; }
.action-btn:active { transform: scale(0.98); }

.nav-btn {
    padding: 0.5rem 1rem; font-size: 0.9rem; border: 1px solid var(--border-color);
    background-color: var(--card-background); color: var(--primary-color);
    border-radius: var(--radius-md); cursor: pointer; text-decoration: none; display: inline-block;
}
.nav-btn:hover { background-color: #f0f0f0; }

.danger-btn { background-color: transparent; border-color: var(--danger-color); color: var(--danger-color); }
.danger-btn:hover { background-color: var(--danger-color); color: white; }

.strava-btn { background-color: #FC4C02; color: white; border: none; font-weight: bold; }
.strava-btn:hover { background-color: #E34402; }

.form-group { margin-bottom: 1.25rem; }
.form-group label { display: block; margin-bottom: 0.5rem; font-weight: 600; font-size: 0.95rem; }
input[type="text"], input[type="number"], input[type="date"], select, textarea {
    width: 100%; padding: 0.8rem; border: 1px solid var(--border-color); border-radius: var(--radius-md);
    font-size: 1rem; background-color: var(--card-background); font-family: inherit;
}

.slider-container { display: flex; align-items: center; gap: 1rem; }
input[type="range"] { flex-grow: 1; cursor: pointer; }

.view-details-btn {
    background: transparent; border: 1px solid var(--border-color); color: var(--muted-text-color);
    width: 100%; padding: 12px; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s;
}
.view-details-btn:hover { border-color: var(--success-color); color: var(--success-color); background: #fff; }

.section-title { font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1.5px; color: var(--muted-text-color); margin: 1.5rem 0 0.5rem 0; font-weight: 700; padding-left: 4px; }

/* ============================================= */
/* === 9. TRAINING CARD (PRE-TRAINING) === */
/* ============================================= */
.training-card {
    background: #fff; border-radius: var(--radius-lg); padding: 1.5rem; margin-bottom: 1.5rem;
    box-shadow: 0 4px 20px rgba(0,0,0,0.06); border: 1px solid var(--border-color);
    transition: transform 0.2s, box-shadow 0.2s; position: relative; overflow: hidden;
}
.training-card::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 6px; background: var(--secondary-color); }
.training-card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.8rem; padding-left: 10px; }
.training-card-header h4 { margin: 0; font-size: 1.1rem; color: var(--text-color); line-height: 1.3; font-weight: 700; }
.training-meta { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 1rem; padding-left: 10px; }
.meta-badge {
    display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px;
    border-radius: 6px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase;
    letter-spacing: 0.5px; line-height: 1;
}
.badge-category { background-color: #f1f5f9; color: #475569; border: 1px solid #e2e8f0; }
.badge-lvl-1, .badge-lvl-2 { background-color: rgba(42, 157, 143, 0.15); color: #264653; border: 1px solid rgba(42, 157, 143, 0.3); }
.badge-lvl-3 { background-color: rgba(233, 196, 106, 0.2); color: #b45309; border: 1px solid rgba(233, 196, 106, 0.4); }
.badge-lvl-4, .badge-lvl-5 { background-color: rgba(231, 111, 81, 0.15); color: #9f1239; border: 1px solid rgba(231, 111, 81, 0.3); }
.badge-equipment { background-color: rgba(0, 95, 115, 0.08); color: var(--primary-color); border: 1px solid rgba(0, 95, 115, 0.2); }

.training-inputs-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px dashed var(--border-color); }
.input-wrapper { display: flex; flex-direction: column; gap: 6px; }
.input-label { font-size: 0.75rem; text-transform: uppercase; font-weight: 700; color: var(--muted-text-color); letter-spacing: 0.5px; }
.modern-input {
    width: 100%; padding: 12px; font-size: 1.1rem; font-weight: 700; color: var(--primary-color);
    background-color: #f8f9fa; border: 2px solid transparent; border-radius: 10px;
    text-align: center; transition: all 0.2s ease; outline: none;
}
.modern-input:focus { background-color: #fff; border-color: var(--secondary-color); box-shadow: 0 4px 12px rgba(10, 147, 150, 0.15); }

.training-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 1rem; font-size: 0.85rem; color: #666; padding-left: 10px; }
.tempo-badge { background: rgba(0,0,0,0.05); padding: 4px 8px; border-radius: 4px; font-family: monospace; }
.video-link { color: var(--secondary-color); text-decoration: none; font-weight: 600; display: flex; align-items: center; gap: 4px; }
.video-link:hover { text-decoration: underline; }

.swap-btn { flex-shrink: 0; background: #f1f5f9; border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; margin-left: 10px; border: none; cursor: pointer;}
.swap-btn:hover { background: var(--primary-color); color: #fff; }

.pre-training-nav {
    display: flex; align-items: center; gap: 15px; margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid var(--border-color);
}
.pre-training-nav .nav-btn { flex: 1; text-align: center; justify-content: center; height: 52px; display: flex; align-items: center; }
.pre-training-nav .action-btn { flex: 2; margin-top: 0 !important; height: 52px; }

.adjustment-panel {
    background: #fff; border: 1px solid var(--primary-color); border-left: 5px solid var(--primary-color);
    border-radius: var(--radius-md); padding: 1rem 1.5rem; margin-bottom: 1.5rem; box-shadow: 0 4px 12px rgba(0,0,0,0.05);
}
.adjustment-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
.adjustment-header h3 { margin: 0; font-size: 1rem; color: var(--primary-color); text-transform: uppercase; letter-spacing: 1px; }
.time-factor-display { font-weight: 800; color: var(--text-color); background: var(--background-color); padding: 2px 8px; border-radius: 4px; }

/* ============================================= */
/* === 10. FOCUS MODE (TRAINING SCREEN) === */
/* ============================================= */
#training-screen {
    background-color: var(--primary-color);
    color: var(--light-text-color);
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 9999;
    display: none;
    overflow: hidden !important;
}
#training-screen.active { display: flex !important; }

.focus-view {
    display: flex; flex-direction: column; height: 100dvh; max-height: 100dvh; overflow: hidden;
    padding: max(1rem, env(safe-area-inset-top)) 1rem max(0px, env(safe-area-inset-bottom)) 1rem;
    max-width: 800px; margin: 0 auto; width: 100%; box-sizing: border-box;
    justify-content: space-between; gap: 0.5vh;
}

.focus-progress-container {
    width: 100%; height: 8px; display: flex; gap: 2px; margin-bottom: 10px;
    background: rgba(0,0,0,0.2); border-radius: 4px; overflow: hidden; flex-shrink: 0;
}
.progress-segment { flex: 1; background-color: rgba(255,255,255,0.15); border-radius: 2px; transition: all 0.3s ease; position: relative; }
.progress-segment.section-warmup { background-color: rgba(233, 196, 106, 0.3); }
.progress-segment.section-main { background-color: rgba(10, 147, 150, 0.3); }
.progress-segment.section-cooldown { background-color: rgba(148, 210, 189, 0.3); }
.progress-segment.completed.section-warmup { background-color: var(--gold-color); }
.progress-segment.completed.section-main { background-color: var(--secondary-color); }
.progress-segment.completed.section-cooldown { background-color: var(--accent-color); }
.progress-segment.active { background-color: #fff !important; box-shadow: 0 0 10px rgba(255,255,255,0.8); transform: scaleY(1.3); }
.progress-segment.rest-pulse { animation: rest-pulse 1.5s infinite; }
@keyframes rest-pulse { 0% { opacity: 0.3; } 50% { opacity: 0.8; box-shadow: 0 0 5px rgba(255,255,255,0.5); } 100% { opacity: 0.3; } }
.progress-segment.paused-active { background-color: #aaa !important; animation: none; }

.focus-header-minimal { display: flex; justify-content: flex-start; align-items: center; width: 100%; margin-bottom: 0; padding-left: 0; flex-shrink: 0; }
.close-training-btn {
    background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.2); border-radius: 50%;
    width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: background 0.2s;
}
.close-training-btn:hover { background: rgba(255,255,255,0.3); }
.close-training-btn img { width: 18px; height: 18px; display: block; filter: brightness(0) invert(1); }

.focus-timer-container { flex-grow: 0; display: flex; align-items: center; justify-content: center; min-height: auto; margin: 0; margin-bottom: -0.5vh; flex-shrink: 1; }
#focus-timer-display {
    font-size: clamp(6rem, 28vw, 14rem); font-weight: 400; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    font-variant-numeric: tabular-nums; line-height: 0.9; margin: 0; text-align: center; letter-spacing: -0.03em;
}
.rep-based-text { font-family: inherit !important; font-size: clamp(3rem, 15vh, 6rem) !important; }

.focus-exercise-info { margin: 0; text-align: center; flex-shrink: 0; }
.exercise-title-container { display: flex; justify-content: center; gap: 10px; align-items: center; max-width: 100%; overflow: hidden; }
#focus-exercise-name {
    font-size: clamp(1.8rem, 5vh, 3.5rem); margin: 0; margin-bottom: 0.2vh; font-weight: 700; line-height: 1.3;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%; flex-shrink: 1; min-width: 0; padding-bottom: 0.2em;
}
#focus-affinity-badge, .tts-button { flex-shrink: 0; }
.tts-button { background: transparent !important; border: none; padding: 0; margin-top: 0; cursor: pointer; opacity: 0.8; flex-shrink: 0; }
.tts-button img { width: 24px; height: 24px; display: block; }
#focus-exercise-details { opacity: 0.8; font-size: clamp(1rem, 2.2vh, 1.3rem); margin-top: 0; font-weight: 500; color: var(--gold-color); }

.focus-controls-wrapper { display: flex; flex-direction: column; align-items: center; gap: 1vh; width: 100%; margin-bottom: 0; flex-shrink: 0; }
.focus-main-action { width: 100%; display: flex; justify-content: center; min-height: 60px; align-items: center; }
.control-btn.action-btn {
    width: 80%; padding: 1.5vh 2vh; font-size: clamp(1rem, 2.5vh, 1.3rem); text-transform: uppercase; letter-spacing: 1px;
    background: var(--success-color); border: none; box-shadow: 0 4px 15px rgba(42, 157, 143, 0.4); color: white; cursor: pointer; border-radius: 50px; margin-top: 0;
}
.focus-secondary-actions { display: flex; gap: 2rem; justify-content: center; align-items: center; }
.control-icon-btn {
    background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2);
    width: clamp(48px, 8vh, 64px); height: clamp(48px, 8vh, 64px);
    border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s;
}
.control-icon-btn img { width: 40%; height: 40%; display: block; }
.paused-state { border-color: var(--gold-color); background: rgba(233, 196, 106, 0.1); animation: pulse-border 1.5s infinite; }
@keyframes pulse-border { 0% { box-shadow: 0 0 0 0 rgba(233, 196, 106, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(233, 196, 106, 0); } 100% { box-shadow: 0 0 0 0 rgba(233, 196, 106, 0); } }
.control-icon-btn.confirm-state { background-color: var(--danger-color); border-color: var(--danger-color); transform: scale(1.1); box-shadow: 0 0 15px rgba(231, 111, 81, 0.5); }
.control-icon-btn.confirm-state img { filter: brightness(0) invert(1); }

.focus-next-up { text-align: center; opacity: 0.6; padding-bottom: 0; font-size: 0.85rem; flex-shrink: 0; margin-top: 0; }

.visual-card-wrapper {
    flex: 1; min-height: 0; width: 100%; max-width: 500px; margin: 0 auto; position: relative;
    cursor: pointer; -webkit-tap-highlight-color: transparent; aspect-ratio: auto; display: flex;
}
.visual-card-wrapper:has(.focus-animation-container.hidden) { width: 100%; max-width: 600px; }
.visual-card-content { position: relative; width: 100%; height: 100%; border-radius: 24px; overflow: hidden; transition: opacity 0.3s ease; }
.focus-description-container {
    background-color: rgba(0, 0, 0, 0.25) !important; color: #ffffff !important; border: 1px solid rgba(255, 255, 255, 0.15);
    padding: 1rem 1.2rem; font-size: 0.95rem; line-height: 1.4; text-align: left;
    display: flex; flex-direction: column; justify-content: flex-start; z-index: 10; overflow-y: auto; height: 100%;
}
.focus-animation-container {
    background-color: #f8f9fa !important; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    display: flex; justify-content: center; align-items: center; padding: 0; z-index: 10; height: 100%;
}
.focus-animation-container svg { width: 100%; height: 100%; display: block; object-fit: contain; }
.flip-indicator {
    position: absolute; bottom: 12px; right: 12px; width: 32px; height: 32px; border-radius: 50%;
    display: flex; justify-content: center; align-items: center; pointer-events: none; z-index: 20; transition: background 0.3s;
}
.focus-description-container:not(.hidden) ~ .flip-indicator { background: rgba(255, 255, 255, 0.15); }
.focus-description-container:not(.hidden) ~ .flip-indicator img { filter: brightness(0) invert(1); }
.focus-animation-container:not(.hidden) ~ .flip-indicator { background: rgba(0, 95, 115, 0.1); }
.flip-indicator img { width: 18px; height: 18px; opacity: 0.8; }
.hidden { display: none !important; }

/* ============================================= */
/* === 11. HISTORY & CALENDAR === */
/* ============================================= */
.calendar-container { background: var(--card-background); padding: 1rem; border-radius: var(--radius-md); box-shadow: var(--shadow-card); }
.calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
.calendar-header h3 { margin: 0; color: var(--primary-color); }
.calendar-header button { background: none; border: none; font-size: 1.5rem; color: var(--primary-color); cursor: pointer; }
.calendar-weekdays, .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; text-align: center; }
.calendar-weekdays { font-weight: bold; color: var(--secondary-color); margin-bottom: 0.5rem; font-size: 0.85rem; }
.calendar-day {
    aspect-ratio: 1; display: flex; flex-direction: column; justify-content: center; align-items: center;
    border-radius: var(--radius-md); font-size: 0.9rem; position: relative; border: 1px solid transparent;
}
.calendar-day.completed { background-color: var(--success-color); color: #fff; cursor: pointer; }
.calendar-day.not_started { background-color: #f5f5f5; color: #bbb; }
.calendar-day.today { border: 2px solid var(--primary-color); font-weight: bold; }
.day-plan { font-size: 0.6rem; margin-top: 2px; }

/* Session Details */
.details-session-card { background: var(--card-background); border: 1px solid var(--border-color); border-radius: var(--radius-lg); margin-bottom: 1.5rem; overflow: hidden; box-shadow: var(--shadow-card); }
.details-session-card[open] summary { border-bottom: 1px solid var(--border-color); background-color: #fcfcfc; }
.details-session-card summary { padding: 1.2rem 1.5rem; cursor: pointer; list-style: none; transition: background 0.2s; }
.summary-content { display: flex; justify-content: space-between; align-items: center; }
.summary-title { font-weight: 700; color: var(--primary-color); font-size: 1.1rem; }
.icon-btn { background: none; border: none; color: #aaa; cursor: pointer; padding: 8px; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
.icon-btn:hover { background-color: #ffebeb; color: var(--danger-color); }
.session-stats-grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(70px, 1fr)); gap: 1rem; padding: 1.5rem;
    background-color: #fff; border-bottom: 1px solid var(--border-color);
}
.stat-item { display: flex; flex-direction: column; align-items: center; text-align: center; }
.stat-label { font-size: 0.7rem; text-transform: uppercase; color: var(--muted-text-color); letter-spacing: 1px; margin-bottom: 4px; }
.stat-value { font-weight: 700; color: var(--text-color); font-size: 1.1rem; }
.session-notes { margin: 1.5rem; padding: 1rem; background: #fffdf0; border-radius: var(--radius-md); font-size: 0.95rem; border: 1px solid #faeec5; }
.history-exercise-list { width: 100%; }
.history-exercise-row {
    display: flex; justify-content: space-between; align-items: center; padding: 0.8rem 1.5rem; border-bottom: 1px solid var(--border-color);
}
.history-exercise-row:nth-child(even) { background-color: #f9f9f9; }
.history-exercise-row:last-child { border-bottom: none; }
.hex-main { display: flex; flex-direction: column; gap: 2px; }
.hex-name { font-weight: 600; font-size: 0.95rem; color: var(--text-color); }
.hex-details { font-size: 0.8rem; color: var(--muted-text-color); }
.status-badge { font-size: 0.7rem; font-weight: 700; padding: 4px 8px; border-radius: 6px; letter-spacing: 0.5px; }
.status-badge.completed { color: var(--success-color); background-color: rgba(42, 157, 143, 0.1); }
.status-badge.skipped { color: var(--danger-color); background-color: rgba(231, 111, 81, 0.1); }

/* ============================================= */
/* === 12. WIZARD / KREATOR === */
/* ============================================= */
#wizard-screen {
    background: radial-gradient(circle at top right, #004e60 0%, #002b36 40%, #000000 100%);
    color: #fff; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000;
    display: none; flex-direction: column; padding: 0; overflow: hidden;
}
#wizard-screen.active { display: flex; }
#wizard-container {
    width: 100%; height: 100%; display: flex; flex-direction: column;
    padding: max(20px, env(safe-area-inset-top)) 20px max(20px, env(safe-area-inset-bottom)) 20px;
    max-width: 600px; margin: 0 auto; box-sizing: border-box; position: relative;
}
.wizard-progress-bar { width: 100%; height: 6px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; margin-bottom: 25px; overflow: hidden; }
.wizard-progress-fill { height: 100%; background: linear-gradient(90deg, var(--gold-color), #f9c74f); transition: width 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); box-shadow: 0 0 10px rgba(233, 196, 106, 0.5); }
.wizard-close-btn {
    position: absolute; top: max(20px, env(safe-area-inset-top)); right: 20px; width: 44px; height: 44px;
    border-radius: 50%; background: rgba(255, 255, 255, 0.08); border: 1px solid rgba(255, 255, 255, 0.15);
    color: #fff; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 2001;
    transition: all 0.2s ease; backdrop-filter: blur(5px);
}
.wizard-close-btn:hover { background: rgba(255, 255, 255, 0.2); transform: scale(1.05); }
.wizard-content { display: flex; flex-direction: column; height: 100%; animation: slideInUp 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); padding-top: 4rem; }
@keyframes slideInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
.wizard-step-title { font-size: 1.8rem; font-weight: 800; margin: 0 0 0.5rem 0; color: #fff; text-align: center; text-shadow: 0 2px 10px rgba(0,0,0,0.5); }
.wizard-step-desc { font-size: 1rem; opacity: 0.8; margin: 0 0 2rem 0; line-height: 1.5; text-align: center; color: #cbd5e1; }
#step-body { flex-grow: 1; overflow-y: auto; margin-bottom: 1rem; width: 100%; scrollbar-width: none; -ms-overflow-style: none; padding: 0 10px; }
#step-body::-webkit-scrollbar { display: none; }
.options-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; padding-bottom: 20px; }
.option-btn {
    background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); color: #fff;
    padding: 16px; border-radius: 16px; font-size: 0.95rem; font-weight: 500; text-align: center;
    cursor: pointer; transition: all 0.25s cubic-bezier(0.25, 0.8, 0.25, 1); display: flex; flex-direction: column;
    align-items: center; justify-content: center; min-height: 80px; position: relative; overflow: hidden;
}
.option-btn:hover { background: rgba(255, 255, 255, 0.1); transform: translateY(-2px); }
.option-btn.selected {
    background: linear-gradient(135deg, rgba(10, 147, 150, 0.2) 0%, rgba(10, 147, 150, 0.4) 100%);
    border-color: var(--gold-color); box-shadow: 0 0 15px rgba(233, 196, 106, 0.2), inset 0 0 20px rgba(10, 147, 150, 0.2);
    font-weight: 700; color: #fff;
}
.option-btn.selected::after {
    content: "✓"; position: absolute; top: 8px; right: 8px; background: var(--gold-color); color: #000;
    width: 20px; height: 20px; border-radius: 50%; font-size: 12px; display: flex; align-items: center;
    justify-content: center; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}
.equipment-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 12px; }
.eq-card {
    background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px;
    padding: 1rem 0.5rem; cursor: pointer; transition: all 0.2s; display: flex; flex-direction: column;
    align-items: center; justify-content: center; text-align: center; aspect-ratio: 1;
}
.eq-card:hover { background: rgba(255, 255, 255, 0.1); }
.eq-card.selected {
    background: linear-gradient(135deg, rgba(10, 147, 150, 0.3) 0%, rgba(10, 147, 150, 0.1) 100%);
    border-color: var(--secondary-color); box-shadow: 0 0 15px rgba(10, 147, 150, 0.3); font-weight: 700;
}
.eq-name { font-size: 0.85rem; line-height: 1.2; }
#wizard-screen input[type="range"] { background: rgba(255,255,255,0.1); height: 6px; border-radius: 3px; border: none; }
#wizard-screen input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none; appearance: none; width: 24px; height: 24px; border-radius: 50%;
    background: var(--gold-color); cursor: pointer; box-shadow: 0 0 10px rgba(233, 196, 106, 0.5); margin-top: -9px;
}
.wizard-nav {
    display: grid; grid-template-columns: 1fr 2fr; gap: 15px; margin-top: auto;
    padding-top: 1.5rem; border-top: 1px solid rgba(255, 255, 255, 0.1); flex-shrink: 0;
}
.wizard-nav.single-btn { grid-template-columns: 1fr; }
.wizard-nav button { height: 56px; border-radius: 12px; font-size: 1.1rem; font-weight: 700; border: none; cursor: pointer; transition: transform 0.1s; margin: 0 !important; }
.wizard-nav button:active { transform: scale(0.98); }
.wizard-nav #wiz-prev { background: transparent; border: 2px solid rgba(255, 255, 255, 0.2); color: rgba(255, 255, 255, 0.8); }
.wizard-nav #wiz-next { background: var(--gold-color); color: #000; box-shadow: 0 4px 15px rgba(233, 196, 106, 0.3); }
.body-map-container svg { filter: drop-shadow(0 0 10px rgba(0,0,0,0.5)); }
.zone { fill: rgba(255, 255, 255, 0.1); stroke: rgba(255, 255, 255, 0.3); stroke-width: 1.5; transition: all 0.2s; }
.zone:hover { fill: rgba(255, 255, 255, 0.2); }
.zone.selected { fill: var(--danger-color); stroke: #fff; filter: drop-shadow(0 0 10px var(--danger-color)); }

/* ============================================= */
/* === 13. POMOC I MODALE === */
/* ============================================= */
.help-container { padding-bottom: 2rem; }
.help-card { background: #fff; border-radius: var(--radius-lg); padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: var(--shadow-card); border: 1px solid var(--border-color); }
.help-card.highlight { border-left: 5px solid var(--secondary-color); background: linear-gradient(145deg, #ffffff 0%, #f4faff 100%); }
.help-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; }
.help-header h3 { margin: 0; color: var(--primary-color); }
.logic-block { margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(0,0,0,0.05); }
.logic-block h4 { margin: 0 0 0.5rem 0; color: var(--text-color); }
.logic-block p { font-size: 0.9rem; opacity: 0.8; margin: 0; line-height: 1.5; }
.icon-legend, .controls-legend { display: flex; flex-direction: column; gap: 1rem; }
.legend-item { display: flex; align-items: flex-start; gap: 1rem; }
.icon-box { width: 40px; height: 40px; background: rgba(0, 95, 115, 0.05); border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
.icon-box img { width: 24px; height: 24px; }
.legend-desc { flex-grow: 1; }
.legend-desc strong { display: block; font-size: 0.95rem; margin-bottom: 0.2rem; color: var(--primary-color); }
.legend-desc p { margin: 0; font-size: 0.85rem; color: var(--muted-text-color); line-height: 1.4; }
.control-pair { display: flex; align-items: center; gap: 15px; font-size: 0.9rem; padding: 0.5rem 0; border-bottom: 1px solid #f0f0f0; }
.control-pair:last-child { border-bottom: none; }
.control-pair img { width: 24px; height: 24px; opacity: 0.8; }

.modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6);
    z-index: 2000; display: flex; justify-content: center; align-items: center; opacity: 0;
    animation: fadeIn 0.2s forwards; backdrop-filter: blur(2px);
}
.swap-modal {
    background: #fff; width: 90%; max-width: 500px; border-radius: var(--radius-lg); padding: 1.5rem;
    box-shadow: 0 20px 50px rgba(0,0,0,0.3); transform: translateY(20px); animation: slideUp 0.2s forwards;
    max-height: 80vh; display: flex; flex-direction: column;
}
.swap-modal h3 { margin-top: 0; color: var(--primary-color); border-bottom: 1px solid var(--border-color); padding-bottom: 0.8rem; margin-bottom: 1rem; }
.swap-options-list { overflow-y: auto; flex-grow: 1; display: flex; flex-direction: column; gap: 0.8rem; }
.alt-exercise-card {
    border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem; cursor: pointer; transition: all 0.2s;
    display: flex; justify-content: space-between; align-items: center;
}
.alt-exercise-card:hover { border-color: var(--secondary-color); background: rgba(10, 147, 150, 0.05); }
.alt-exercise-card.selected { border-color: var(--primary-color); background: rgba(0, 95, 115, 0.1); border-width: 2px; }
.alt-info h4 { margin: 0 0 0.3rem 0; font-size: 1rem; }
.alt-info p { margin: 0; font-size: 0.8rem; color: var(--muted-text-color); }
.alt-badge { font-size: 0.7rem; background: #eee; padding: 2px 6px; border-radius: 4px; margin-right: 5px; }
.swap-actions { margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid var(--border-color); display: flex; flex-direction: column; gap: 0.8rem; }
.swap-type-toggle, .swap-actions > div[style*="display:flex"] { display: flex !important; align-items: stretch !important; gap: 10px !important; margin-bottom: 10px; }
.toggle-btn { flex: 1; padding: 8px; border: 1px solid var(--border-color); background: #fff; border-radius: 6px; cursor: pointer; font-size: 0.85rem; }
.toggle-btn.active { background: var(--primary-color); color: #fff; border-color: var(--primary-color); }
@keyframes slideUp { to { transform: translateY(0); } }

/* Evolution Modal */
.evolution-modal {
    background: linear-gradient(160deg, #0f1c2e 0%, #003d4d 100%); color: #fff; text-align: center; padding: 2.5rem 1.5rem;
    border-radius: 20px; width: 90%; max-width: 400px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); position: relative;
    overflow: hidden; animation: popIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.evolution-modal::before {
    content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
    background: conic-gradient(from 0deg, transparent 0deg, rgba(233, 196, 106, 0.1) 60deg, transparent 120deg);
    animation: rotateRay 10s linear infinite; pointer-events: none;
}
@keyframes rotateRay { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
@keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
.evo-icon-wrapper {
    position: relative; width: 80px; height: 80px; margin: 0 auto 1.5rem auto; background: rgba(255,255,255,0.1);
    border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 2px solid var(--gold-color);
    box-shadow: 0 0 30px rgba(233, 196, 106, 0.4);
}
.evo-title { font-size: 1.8rem; font-weight: 800; margin: 0 0 0.5rem 0; color: var(--gold-color); text-transform: uppercase; letter-spacing: 2px; }
.evo-desc { font-size: 0.95rem; opacity: 0.8; margin-bottom: 2rem; line-height: 1.5; }
.change-box { background: rgba(0,0,0,0.3); border-radius: 10px; padding: 1rem; margin-bottom: 2rem; border: 1px solid rgba(255,255,255,0.1); }
.change-arrow { font-size: 1.5rem; margin: 0.5rem 0; color: var(--gold-color); }
.ex-name { font-weight: 700; font-size: 1.1rem; }

/* ============================================= */
/* === 14. STOPKA I INNE === */
/* ============================================= */
#app-footer {
    background-color: var(--card-background); border-top: 1px solid var(--border-color); padding: 2rem 1rem;
    text-align: center; color: var(--muted-text-color); font-size: 0.85rem; margin-top: auto;
}
.footer-content { max-width: 600px; margin: 0 auto; }
#app-footer .disclaimer { font-style: italic; margin-bottom: 0.5rem; font-size: 0.8rem; }
.legal-links { margin: 1rem 0; font-size: 0.85rem; }
.legal-links a { color: var(--text-color); opacity: 0.7; text-decoration: none; transition: opacity 0.2s; border-bottom: 1px dotted var(--border-color); }
.legal-links a:hover { opacity: 1; color: var(--primary-color); border-bottom-style: solid; }
.separator { margin: 0 8px; opacity: 0.4; }

#app-bottom-nav {
    display: none; position: fixed; bottom: 0; left: 0; width: 100%; background-color: var(--card-background);
    border-top: 1px solid var(--border-color); z-index: 1000; padding-bottom: env(safe-area-inset-bottom);
}
.bottom-nav-btn { flex: 1; background: none; border: none; padding: 0.5rem 0; display: flex; flex-direction: column; align-items: center; color: var(--muted-text-color); cursor: pointer; }
.bottom-nav-btn .icon { font-size: 1.4rem; margin-bottom: 2px; }
.bottom-nav-btn .label { font-size: 0.7rem; }
.bottom-nav-btn.active { color: var(--primary-color); }

#loading-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.8);
    z-index: 9999; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(2px);
    transition: opacity 0.3s;
}
.loader-logo { width: 64px; height: 64px; border-radius: 50%; box-shadow: 0 0 20px rgba(0, 95, 115, 0.2); }
.pulsate-slow { animation: pulse-fade 1.5s infinite ease-in-out; }
@keyframes pulse-fade { 0% { transform: scale(0.95); opacity: 0.8; } 50% { transform: scale(1.05); opacity: 1; box-shadow: 0 0 30px rgba(10, 147, 150, 0.5); } 100% { transform: scale(0.95); opacity: 0.8; } }

/* Skeleton Loading */
@keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
.skeleton-loading {
    background: #f6f7f8; background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%; animation: shimmer 1.5s infinite linear; border-radius: 4px; width: 100%;
}
.skeleton-hero { border-radius: var(--radius-lg); height: 140px; margin-bottom: 2rem; opacity: 0.7; }
.skeleton-card { background: #fff; border-radius: var(--radius-lg); padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: 0 4px 12px rgba(0,0,0,0.03); border: 1px solid var(--border-color); }
.skeleton-header { display: flex; justify-content: space-between; margin-bottom: 1.5rem; }
.skeleton-text { height: 1.2rem; margin-bottom: 0.5rem; }
.skeleton-text.sm { height: 0.8rem; width: 40%; }
.skeleton-text.md { height: 1.5rem; width: 70%; }
.skeleton-text.lg { height: 1rem; width: 100%; margin-top: 1rem; }
.skeleton-wellness { height: 60px; margin-top: 1.5rem; border-radius: 12px; }
.skeleton-btn { height: 50px; border-radius: 8px; margin-top: 1.5rem; }
.skeleton-queue-item { height: 80px; margin-bottom: 10px; border-radius: var(--radius-md); }

/* --- AI LOADING STATE --- */
.mission-card-wrapper { position: relative; width: 100%; margin-bottom: 2rem; }
.ai-blur { filter: blur(4px) grayscale(80%); opacity: 0.7; pointer-events: none; transition: filter 0.3s ease, opacity 0.3s ease; }
.ai-processing-overlay {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column;
    align-items: center; justify-content: center; z-index: 10; animation: fadeIn 0.3s ease;
}
.ai-badge {
    background: rgba(0, 0, 0, 0.85); color: var(--gold-color); padding: 10px 20px; border-radius: 30px;
    font-size: 0.9rem; font-weight: 700; box-shadow: 0 10px 25px rgba(0,0,0,0.3); display: flex; align-items: center;
    gap: 10px; border: 1px solid rgba(233, 196, 106, 0.3);
}
.ai-badge .spinner-dots {
    width: 12px; height: 12px; border: 2px solid var(--gold-color); border-radius: 50%;
    border-top-color: transparent; animation: spin 1s linear infinite;
}
@keyframes spin { 100% { transform: rotate(360deg); } 100% { transform: rotate(360deg); } }

/* ============================================= */
/* === 15. ATLAS / LIBRARY SCREEN === */
/* ============================================= */
.atlas-header {
position: sticky;
top: 0;
background: var(--background-color);
z-index: 50;
padding-bottom: 5px;
padding-top: 10px;
width: 100%;
}
.search-bar-wrapper {
position: relative;
margin-bottom: 10px;
display: flex;
align-items: center;
width: 100%;
}
.atlas-search-input {
width: 100%;
padding: 12px 16px;
border-radius: 12px;
border: 1px solid var(--border-color);
background: #fff;
font-size: 0.95rem;
box-shadow: 0 2px 8px rgba(0,0,0,0.03);
outline: none;
color: var(--text-color);
transition: border-color 0.2s, box-shadow 0.2s;
}
.atlas-search-input:focus {
border-color: var(--primary-color);
box-shadow: 0 4px 12px rgba(0,95,115,0.15);
}

/* --- ZONE SELECTOR (HUD) - SCROLLBAR FIX --- */
.zone-hud-container {
    display: flex;
    gap: 10px;
    overflow-x: auto;
    padding: 5px 2px 15px 2px;
    -webkit-overflow-scrolling: touch;

    /* Custom Scrollbar Styling (Not hidden anymore) */
    scrollbar-width: thin;
    scrollbar-color: rgba(0, 95, 115, 0.3) transparent;
}

/* WebKit Scrollbar Styling */
.zone-hud-container::-webkit-scrollbar {
    height: 6px;
    display: block; /* Show scrollbar */
}

.zone-hud-container::-webkit-scrollbar-track {
    background: transparent;
}

.zone-hud-container::-webkit-scrollbar-thumb {
    background-color: rgba(0, 95, 115, 0.2);
    border-radius: 10px;
}

.zone-hud-container::-webkit-scrollbar-thumb:hover {
    background-color: rgba(0, 95, 115, 0.5);
}

.zone-tile {
flex: 0 0 auto;
width: 110px;
height: 70px;
background: #fff;
border-radius: 12px;
border: 1px solid var(--border-color);
position: relative;
overflow: hidden;
cursor: pointer;
transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
display: flex;
flex-direction: column;
justify-content: center;
padding: 12px;
}

.zone-tile:active { transform: scale(0.96); }

/* Aktywna strefa */
.zone-tile.active {
border-color: var(--primary-color);
background: #f0fdfa;
box-shadow: 0 4px 12px rgba(0,95,115,0.15);
}

.zt-header {
display: flex;
justify-content: space-between;
align-items: center;
font-size: 0.8rem;
font-weight: 700;
color: var(--text-color);
margin-bottom: 4px;
}

.zt-count {
font-size: 0.7rem;
font-weight: 500;
color: var(--muted-text-color);
}

.zone-tile.active .zt-count {
color: var(--primary-color);
font-weight: 700;
}

/* --- CHIPS (Secondary Filter) - SCROLLBAR FIX --- */
.chips-scroller {
    display: flex;
    flex-wrap: nowrap;
    gap: 8px;
    overflow-x: auto;
    padding: 0 2px 10px 2px;
    -webkit-overflow-scrolling: touch;

    /* Custom Scrollbar Styling */
    scrollbar-width: thin;
    scrollbar-color: rgba(0, 95, 115, 0.3) transparent;
}

.chips-scroller::-webkit-scrollbar {
    height: 4px; /* Thinner for chips */
    display: block;
}

.chips-scroller::-webkit-scrollbar-track {
    background: transparent;
}

.chips-scroller::-webkit-scrollbar-thumb {
    background-color: rgba(0, 95, 115, 0.2);
    border-radius: 10px;
}

.chip {
flex: 0 0 auto;
padding: 6px 14px;
border-radius: 20px;
background: #f8f9fa;
border: 1px solid transparent;
font-size: 0.8rem;
font-weight: 600;
color: var(--muted-text-color);
cursor: pointer;
transition: all 0.2s;
}
.chip.active {
background: #fff;
color: var(--primary-color);
border-color: var(--primary-color);
box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

/* --- EXERCISE CARDS --- */
.atlas-grid {
display: flex; flex-direction: column; gap: 12px; padding-bottom: 80px;
}
.atlas-card {
background: #fff;
border-radius: 12px;
padding: 14px;
display: grid;
grid-template-columns: 1fr auto;
gap: 12px;
align-items: start;
border: 1px solid var(--border-color);
border-left-width: 5px;
box-shadow: 0 2px 5px rgba(0,0,0,0.03);
}
.ac-title { font-weight: 700; font-size: 1rem; color: var(--text-color); line-height: 1.3; }

/* FIX: Opis rozwijany */
.ac-desc {
    font-size: 0.8rem;
    color: #666;
    line-height: 1.4;

    /* Domyślnie zwinięte */
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    margin-top: 4px;

    /* Interakcja */
    cursor: pointer;
    transition: max-height 0.3s;
}

.ac-desc.expanded {
    -webkit-line-clamp: unset;
    line-clamp: unset;
    display: block; /* Override flex display if needed */
}

.ac-tags { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 6px; }
.meta-tag { font-size: 0.65rem; padding: 3px 8px; border-radius: 6px; font-weight: 700; display: inline-flex; align-items: center; gap: 4px; text-transform: uppercase; white-space: nowrap; }
.tag-level { background: #e0f2fe; color: #0369a1; border: 1px solid #bae6fd; }
.tag-category { background: #f1f5f9; color: #475569; border: 1px solid #e2e8f0; }
.tag-equipment { background: #f0fdf4; color: #15803d; border: 1px solid #bbf7d0; }

.ac-footer { display: flex; gap: 12px; margin-top: 10px; padding-top: 8px; border-top: 1px dashed #eee; }
.link-btn { font-size: 0.75rem; text-decoration: none; color: var(--secondary-color); font-weight: 600; display: flex; align-items: center; gap: 4px; background: none; border: none; cursor: pointer; padding: 0; }

.ac-actions { display: flex; flex-direction: column; align-items: center; gap: 8px; min-width: 55px; border-left: 1px solid #eee; padding-left: 10px; justify-content: center; height: 100%; }
.ac-score { font-weight: 800; font-size: 0.85rem; opacity: 0.8; background: #f3f4f6; padding: 4px 8px; border-radius: 6px; min-width: 40px; text-align: center; }

/* Tier Borders */
.atlas-card[data-tier="S"] { border-left-color: #f59e0b; background: linear-gradient(90deg, #fffbeb 0%, #fff 100%); }
.atlas-card[data-tier="A"] { border-left-color: #10b981; }
.atlas-card[data-tier="B"] { border-left-color: #9ca3af; }
.atlas-card[data-tier="C"] { border-left-color: #ef4444; }

/* ============================================= */
/* === 16. SUMMARY SECTION (FIXED FLEXBOX) === */
/* ============================================= */
.feedback-container {
    display: flex;
    gap: 10px;
    justify-content: space-between;
}

.feedback-option {
    flex: 1;
    border: 1px solid #ddd;
    border-radius: 8px;
    text-align: center;
    padding: 10px;
    cursor: pointer;
    transition: all 0.2s;
    background-color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
}

.feedback-option:hover {
    background-color: #f9f9f9;
}

.feedback-option.selected {
    border-color: var(--primary-color);
    background-color: #e0f2fe;
    box-shadow: 0 2px 5px rgba(0, 95, 115, 0.2);
}

.fb-icon {
    font-size: 1.5rem;
}

.fb-text h4 {
    margin: 0;
    font-size: 0.85rem;
    font-weight: 600;
}

/* Exercise Ratings */
.ratings-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.rating-card {
    background: #fff;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.rating-name {
    font-size: 0.9rem;
    font-weight: 600;
    max-width: 50%;
}

.rating-actions {
    display: flex;
    gap: 5px;
    align-items: center;
}

/* --- RATE BUTTON FIX --- */
.rate-btn {
    background: #f3f4f6; /* Zawsze szare/jasne tło */
    border: 1px solid transparent;
    border-radius: 8px;
    width: 40px;
    height: 40px;
    font-size: 1.4rem;
    cursor: pointer;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    justify-content: center;

    /* Domyślnie: ikona szara i lekko przezroczysta */
    filter: grayscale(100%);
    opacity: 0.4;
}

.rate-btn:hover {
    opacity: 0.7;
    background: #e5e7eb;
    transform: translateY(-1px);
}

/* AKTYWNY: Ikona odzyskuje kolor, tło pozostaje jasne/neutralne */
.rate-btn.active {
    opacity: 1;
    filter: grayscale(0%); /* PRZYWRACA KOLOR EMOJI */
    background: #fff;      /* Tło białe dla kontrastu */
    border-color: #d1d5db; /* Delikatna ramka */
    box-shadow: 0 2px 5px rgba(0,0,0,0.08); /* Lekki cień */
    transform: scale(1.15); /* Lekkie powiększenie */
}

.sep {
    width: 1px;
    height: 24px;
    background: #ddd;
    margin: 0 4px;
}

.empty-state {
    text-align: center;
    color: var(--muted-text-color);
    font-style: italic;
    padding: 1rem;
    background: rgba(0,0,0,0.02);
    border-radius: 8px;
}

.update-notification {
    position: fixed;
    bottom: 80px; /* Powyżej dolnej nawigacji */
    left: 50%;
    transform: translateX(-50%);
    background-color: #333;
    color: white;
    padding: 12px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    z-index: 10000;
    width: 90%;
    max-width: 400px;
    animation: slideUpFade 0.5s ease;
}

.update-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 10px;
}

.update-content span {
    font-size: 0.9rem;
    font-weight: 500;
}

.update-content button {
    background-color: var(--secondary-color);
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 4px;
    font-weight: 700;
    cursor: pointer;
    text-transform: uppercase;
    font-size: 0.8rem;
}

.update-content button:active {
    transform: scale(0.95);
}

@keyframes slideUpFade {
    from { opacity: 0; transform: translate(-50%, 20px); }
    to { opacity: 1; transform: translate(-50%, 0); }
}

/* ============================================= */
/* === 17. MEDIA QUERIES (FULL) === */
/* ============================================= */
@media (max-width: 768px) {
    .desktop-only { display: none !important; }
    .mobile-only { display: block !important; }
    header { padding: 0.8rem 1rem; justify-content: space-between; }
    header nav#main-nav { display: none !important; }
    #user-display-name { display: none; }
    #user-info-container { border-left: none; padding-left: 0; gap: 10px; }
    #logout-btn { padding: 0.4rem; background: transparent; border: none; }
    #app-bottom-nav { display: flex; }
    
    #hero-dashboard {
        display: grid; grid-template-columns: auto 1fr; gap: 1rem; padding: 12px 1rem;
        background: linear-gradient(160deg, #0f1c2e 0%, var(--primary-color) 90%);
    }
    
    .hero-metrics-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 3px; width: 100%; margin-top: 4px; }
    .metric-item { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 4px 0; background: rgba(0,0,0,0.25); border-radius: 6px; border: 1px solid rgba(255, 255, 255, 0.05); min-height: 42px; }
    .metric-icon { width: 18px !important; height: 18px !important; margin-right: 0; margin-bottom: 1px; opacity: 1 !important; }
    .metric-label { display: none; }
    .metric-value { font-size: 0.7rem; font-weight: 700; line-height: 1.1; white-space: nowrap; color: #fff; letter-spacing: -0.5px; }
    
    /* Ukrycie starego wykresu tygodniowego na mobile */
    .hero-weekly-rhythm { display: flex; } /* Przywrócono widoczność wykresu na mobile */
    
    .mission-card { padding: 1rem; margin-bottom: 1rem; }
    .ai-header-strip { margin: -1rem -1rem 0.8rem -1rem; padding: 0.4rem 1rem; font-size: 0.7rem; }
    .mission-title { font-size: 1.3rem; margin: 0.2rem 0; line-height: 1.2; }
    .mission-day-badge { font-size: 0.65rem; padding: 2px 8px; }
    .estimated-time-badge { font-size: 0.8rem; padding: 2px 8px; }
    .ai-mini-tags { margin-bottom: 0.5rem; padding-bottom: 0.5rem; gap: 6px; }
    .wellness-section { margin-top: 0.8rem; padding-top: 0.8rem; }
    .wellness-label { margin-bottom: 0.5rem; font-size: 0.8rem; }
    .pain-option { padding: 6px 4px; font-size: 1.2rem; border-radius: 8px; gap: 2px; }
    .pain-option span { font-size: 0.55rem; font-weight: 600; }
    .action-btn { margin-top: 0.8rem; padding: 0.8rem; font-size: 1rem; }
    
    /* Stylizacja Kartki z Kalendarza na Mobile */
    .calendar-day-number { font-size: 4.5rem; }
    .calendar-date-header { padding: 1.5rem 1rem 0.5rem 1rem; }
    .calendar-body { padding: 1rem; }
    
    #app-footer { padding-bottom: 100px !important; }
}

@media (min-width: 769px) {
    .mobile-only { display: none !important; }
    .desktop-only { display: inline-block !important; }
}